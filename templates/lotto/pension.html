{% extends 'base.html' %}

{% block title %}ğŸ’° ì—°ê¸ˆë³µê¶Œ 720+ ë²ˆí˜¸ ìƒì„±ê¸° | ë¬´ë£Œ ì¶”ì²¨ | {{ latest_pension.round|default:"ìµœì‹ " }}íšŒ ë‹¹ì²¨ë²ˆí˜¸{% endblock %}

{% block description %}ğŸ¯ 2025ë…„ ìµœì‹  ì—°ê¸ˆë³µê¶Œ 720+ ë²ˆí˜¸ ìƒì„±ê¸°! ì¡°-ë²ˆí˜¸-íšŒì°¨ë¥¼ ìë™ ìƒì„±í•˜ì—¬ í–‰ìš´ì˜ ë²ˆí˜¸ë¥¼ ë§Œë“œì„¸ìš”. {{ latest_pension.round|default:"ìµœì‹ " }}íšŒ ë‹¹ì²¨ë²ˆí˜¸ í™•ì¸, ì—­ëŒ€ ë‹¹ì²¨ ê¸°ë¡ê¹Œì§€ ëª¨ë“  ê¸°ëŠ¥ ë¬´ë£Œ ì œê³µ!{% endblock %}

{% block content %}
<main class="container">
    <article class="row">
        <div class="col-lg-8 mx-auto">
            <header class="mb-4">
                <h1 class="text-center">ğŸ’° ì—°ê¸ˆë³µê¶Œ 720+ ë²ˆí˜¸ ìƒì„±ê¸°</h1>
                <p class="lead text-center">ğŸ† ì›” 700ë§Œì›! 20ë…„ê°„ ì—°ê¸ˆì²˜ëŸ¼ ë°›ëŠ” ì—°ê¸ˆë³µê¶Œ ë²ˆí˜¸ë¥¼ ìƒì„±í•´ë³´ì„¸ìš”!</p>
                <div class="alert alert-info text-center">
                    <small><strong>ğŸ”” ì•ˆë‚´:</strong> ë³¸ ì‚¬ì´íŠ¸ëŠ” êµìœ¡ ë° ì˜¤ë½ ëª©ì ì˜ ë²ˆí˜¸ ìƒì„± ë„êµ¬ì…ë‹ˆë‹¤. ì‹¤ì œ ë‹¹ì²¨ì„ ë³´ì¥í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</small>
                </div>
            </header>

            <!-- ë²ˆí˜¸ ì¶”ì²¨ ì¹´ë“œ -->
            <section class="card mb-4">
                <div class="card-header">
                    <h2 style="margin: 0; font-size: 1.25rem;"><i class="fas fa-random"></i> ì—°ê¸ˆë³µê¶Œ ë²ˆí˜¸ ì¶”ì²¨</h2>
                </div>
                <div class="card-body">
                    <p class="card-text">ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ ì—°ê¸ˆë³µê¶Œ ë²ˆí˜¸ê°€ ìƒì„±ë©ë‹ˆë‹¤. (ì¡°-ë²ˆí˜¸)</p>

                    <!-- ìƒì„± ê°œìˆ˜ ì„ íƒ -->
                    <div class="mb-3">
                        <label class="form-label">ìƒì„±í•  ë²ˆí˜¸ ê°œìˆ˜</label>
                        <div class="btn-group w-100" role="group">
                            <input type="radio" class="btn-check" name="pensionCount" id="pCount1" value="1" checked>
                            <label class="btn btn-outline-success" for="pCount1">1ê°œ</label>

                            <input type="radio" class="btn-check" name="pensionCount" id="pCount3" value="3">
                            <label class="btn btn-outline-success" for="pCount3">3ê°œ</label>

                            <input type="radio" class="btn-check" name="pensionCount" id="pCount5" value="5">
                            <label class="btn btn-outline-success" for="pCount5">5ê°œ</label>

                            <input type="radio" class="btn-check" name="pensionCount" id="pCount10" value="10">
                            <label class="btn btn-outline-success" for="pCount10">10ê°œ</label>
                        </div>
                    </div>

                    <!-- ìƒì„± ëª¨ë“œ ì„ íƒ -->
                    <div class="mb-3">
                        <label class="form-label">ìƒì„± ëª¨ë“œ</label>
                        <div class="btn-group w-100" role="group">
                            <input type="radio" class="btn-check" name="pensionMode" id="pModeRandom" value="random" checked>
                            <label class="btn btn-outline-primary" for="pModeRandom">ëœë¤</label>

                            <input type="radio" class="btn-check" name="pensionMode" id="pModeHot" value="hot">
                            <label class="btn btn-outline-danger" for="pModeHot">í•«(ë§ì´ ë‚˜ì˜¨)</label>

                            <input type="radio" class="btn-check" name="pensionMode" id="pModeCold" value="cold">
                            <label class="btn btn-outline-secondary" for="pModeCold">ì½œë“œ(ëœ ë‚˜ì˜¨)</label>

                            <input type="radio" class="btn-check" name="pensionMode" id="pModeBalanced" value="balanced">
                            <label class="btn btn-outline-success" for="pModeBalanced">ê· í˜•</label>
                        </div>
                    </div>

                    <button id="generatePensionBtn" class="btn btn-primary btn-lg w-100">
                        <i class="fas fa-sync-alt"></i> ì—°ê¸ˆë³µê¶Œ ë²ˆí˜¸ ì¶”ì²¨í•˜ê¸°
                    </button>

                    <div class="loading" style="display: none; text-align: center; padding: 20px;">
                        <i class="fas fa-spinner fa-spin fa-2x"></i>
                        <p>ì¶”ì²¨ ì¤‘...</p>
                    </div>

                    <div id="pensionResult" class="mt-4" style="min-height: 80px;">
                        <!-- ì¶”ì²¨ëœ ë²ˆí˜¸ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                </div>
            </section>

            <!-- ìµœì‹  ë‹¹ì²¨ë²ˆí˜¸ -->
            {% if latest_pension %}
            <section class="card mb-4">
                <div class="card-header bg-success text-white">
                    <h2 style="margin: 0; font-size: 1.25rem;"><i class="fas fa-trophy"></i> {{ latest_pension.round }}íšŒ ì—°ê¸ˆë³µê¶Œ ë‹¹ì²¨ë²ˆí˜¸ - {{ latest_pension.date }}</h2>
                </div>
                <div class="card-body text-center">
                    <div class="pension-number-display">
                        <div class="pension-group">
                            <span class="label">ì¡°</span>
                            <span class="value">{{ latest_pension.group }}</span>
                        </div>
                        <div class="pension-main-number">
                            <span class="label">ë²ˆí˜¸</span>
                            <span class="value">{{ latest_pension.number }}</span>
                        </div>
                        <div class="pension-bonus">
                            <span class="label">ë³´ë„ˆìŠ¤ ë²ˆí˜¸</span>
                            <span class="value">{{ latest_pension.bonus }}</span>
                        </div>
                    </div>
                </div>
            </section>
            {% endif %}

            <!-- ìµœê·¼ ë‹¹ì²¨ë²ˆí˜¸ ì´ë ¥ -->
            <section class="card mb-4">
                <div class="card-header">
                    <i class="fas fa-history"></i> ìµœê·¼ ë‹¹ì²¨ë²ˆí˜¸ ì´ë ¥
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-hover">
                            <thead class="table-light">
                                <tr>
                                    <th>íšŒì°¨</th>
                                    <th>ì¶”ì²¨ì¼</th>
                                    <th>ì¡°</th>
                                    <th>ë²ˆí˜¸</th>
                                    <th>ë³´ë„ˆìŠ¤ ë²ˆí˜¸</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for pension in recent_pensions %}
                                <tr>
                                    <td><strong>{{ pension.round }}íšŒ</strong></td>
                                    <td>{{ pension.date }}</td>
                                    <td><span class="badge bg-primary">{{ pension.group }}ì¡°</span></td>
                                    <td><span class="pension-number-small">{{ pension.number }}</span></td>
                                    <td><span class="badge bg-warning text-dark">{{ pension.bonus }}</span></td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>

            <!-- ì—°ê¸ˆë³µê¶Œ ì •ë³´ -->
            <section class="card mb-4">
                <div class="card-header">
                    <i class="fas fa-info-circle"></i> ì—°ê¸ˆë³µê¶Œ 720+ ì •ë³´
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6">
                            <h3><i class="fas fa-trophy"></i> ë‹¹ì²¨ ë“±ê¸‰</h3>
                            <div class="table-responsive">
                                <table class="table table-sm table-bordered">
                                    <thead class="table-light">
                                        <tr>
                                            <th>ë“±ìˆ˜</th>
                                            <th>ë‹¹ì²¨ ì¡°ê±´</th>
                                            <th>ë‹¹ì²¨ê¸ˆ</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>1ë“±</td>
                                            <td>ì¡°+ë²ˆí˜¸+íšŒì°¨</td>
                                            <td>ì›” 700ë§Œì› (20ë…„)</td>
                                        </tr>
                                        <tr>
                                            <td>2ë“±</td>
                                            <td>ì¡°+ë²ˆí˜¸</td>
                                            <td>ì›” 100ë§Œì› (10ë…„)</td>
                                        </tr>
                                        <tr>
                                            <td>3ë“±</td>
                                            <td>ë²ˆí˜¸+íšŒì°¨</td>
                                            <td>100ë§Œì›</td>
                                        </tr>
                                        <tr>
                                            <td>4ë“±</td>
                                            <td>ë²ˆí˜¸</td>
                                            <td>10ë§Œì›</td>
                                        </tr>
                                        <tr>
                                            <td>5ë“±</td>
                                            <td>ì¡°+íšŒì°¨</td>
                                            <td>5ë§Œì›</td>
                                        </tr>
                                        <tr>
                                            <td>6ë“±</td>
                                            <td>íšŒì°¨</td>
                                            <td>5ì²œì›</td>
                                        </tr>
                                        <tr>
                                            <td>7ë“±</td>
                                            <td>ì¡°</td>
                                            <td>1ì²œì›</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <h3><i class="fas fa-calculator"></i> 1ë“± ì´ ìˆ˜ë ¹ì•¡</h3>
                            <div class="alert alert-success">
                                <h4 class="text-center">16ì–µ 8ì²œë§Œì›</h4>
                                <p class="text-center mb-0">
                                    <small>ì›” 700ë§Œì› Ã— 20ë…„ (240ê°œì›”)</small>
                                </p>
                            </div>

                            <h3 class="mt-4"><i class="fas fa-shopping-cart"></i> êµ¬ë§¤ ë°©ë²•</h3>
                            <ul>
                                <li>ì „êµ­ ë¡œë˜ íŒë§¤ì ì—ì„œ êµ¬ë§¤ ê°€ëŠ¥</li>
                                <li>1ì¥ë‹¹ 1,000ì› (5ê²Œì„)</li>
                                <li>ë§¤ì£¼ ëª©ìš”ì¼ ì¶”ì²¨</li>
                                <li>ë™í–‰ë³µê¶Œ ì•±ì—ì„œ ì˜¨ë¼ì¸ êµ¬ë§¤ ê°€ëŠ¥</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </article>
</main>

<style>
.pension-number-display {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 30px;
    padding: 30px;
    font-size: 1.5rem;
}

.pension-group, .pension-main-number, .pension-bonus {
    display: flex;
    flex-direction: column;
    align-items: center;
}

.pension-number-display .label {
    font-size: 0.9rem;
    color: #666;
    margin-bottom: 10px;
}

.pension-number-display .value {
    font-size: 2.5rem;
    font-weight: bold;
    color: #28a745;
    font-family: 'Courier New', monospace;
}

.pension-group .value {
    color: #007bff;
}

.pension-bonus .value {
    color: #ffc107;
}

.pension-number-small {
    font-family: 'Courier New', monospace;
    font-weight: bold;
    font-size: 1.1rem;
    color: #28a745;
}

.generated-pension {
    background: #f8f9fa;
    border: 2px solid #28a745;
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 15px;
}

.generated-pension .pension-display {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 20px;
    font-family: 'Courier New', monospace;
}

.generated-pension .group {
    background: #007bff;
    color: white;
    padding: 10px 20px;
    border-radius: 5px;
    font-size: 1.5rem;
    font-weight: bold;
}

.generated-pension .number {
    background: #28a745;
    color: white;
    padding: 10px 20px;
    border-radius: 5px;
    font-size: 1.8rem;
    font-weight: bold;
    letter-spacing: 2px;
}

.generated-pension .bonus {
    background: #ffc107;
    color: #333;
    padding: 10px 20px;
    border-radius: 5px;
    font-size: 1.5rem;
    font-weight: bold;
}
</style>

{% endblock %}

{% block extra_js %}
<script>
    $(document).ready(function() {
        // ì—°ê¸ˆë³µê¶Œ ë²ˆí˜¸ ìƒì„± ë²„íŠ¼ í´ë¦­
        $("#generatePensionBtn").click(function() {
            generatePensionNumbers();
        });

        function generatePensionNumbers() {
            $("#pensionResult").empty();
            $(".loading").show();

            const count = $('input[name="pensionCount"]:checked').val();
                const mode = $('input[name="pensionMode"]:checked').val();
                const apiUrl = `/lottery/pension/numbers?count=${count}&mode=${mode}`;

            fetch(apiUrl)
                .then(response => response.json())
                .then(data => {
                    let html = '';

                    data.pension_numbers.forEach((pension, index) => {
                        html += `
                            <div class="generated-pension" style="animation: fadeIn 0.5s ease-in ${index * 0.2}s both;">
                                ${data.pension_numbers.length > 1 ? `<div class="text-center mb-2"><strong>${index + 1}ë²ˆì§¸ ë²ˆí˜¸</strong></div>` : ''}
                                <div class="pension-display">
                                    <div class="group">${pension.group}ì¡°</div>
                                    <div class="number">${pension.number}</div>
                                </div>
                            </div>
                        `;
                    });

                    html += `<div class="text-center mt-3"><small class="text-muted"><i class="fas fa-info-circle"></i> ${data.info}</small></div>`;

                    $("#pensionResult").html(html);
                    $(".loading").hide();
                })
                .catch(error => {
                    $("#pensionResult").html('<div class="alert alert-danger">ë²ˆí˜¸ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</div>');
                    $(".loading").hide();
                    console.error("API í˜¸ì¶œ ì˜¤ë¥˜:", error);
                });
        }
    });
</script>

<style>
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}
</style>
{% endblock %}
